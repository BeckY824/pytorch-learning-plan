## 2.1 数据操作：张量基础总结

### ✅ 一、什么是张量（tensor）

* 张量是多维数组，是 PyTorch 中最基本的数据结构。
* 常见维度：

  * 0维：标量（如 `torch.tensor(3.0)`）
  * 1维：向量（如 `[1, 2, 3]`）
  * 2维：矩阵（如 3x3）
  * n维：图像/视频等高维数据

---

### ✅ 二、创建张量的方式

```python
torch.tensor([1, 2, 3])          # 手动输入数据
torch.zeros((2, 3))             # 全0
torch.ones((2, 3))              # 全1
torch.rand((2, 3))              # [0,1) 区间随机
torch.arange(0, 10, 2)          # 等差数列
```

---

### ✅ 三、张量的形状与变换

| 操作                | 说明          |
| ----------------- | ----------- |
| `.shape`          | 查看维度        |
| `.reshape((m,n))` | 改变形状        |
| `.view((m,n))`    | 改变形状（需连续内存） |
| `.numel()`        | 返回元素总数      |
| `.flatten()`      | 拉成一维        |
| `.unsqueeze(dim)` | 增加维度        |
| `.squeeze()`      | 去除维度为1的轴    |

---

### ✅ 四、基本逐元素操作

```python
a + b
a - b
a * b
a / b
torch.exp(a)
torch.pow(a, 2)
```

---

### ✅ 五、广播机制（broadcasting）

自动扩展形状不一致的张量进行操作：

```python
a = torch.ones((2, 3))
b = torch.tensor([1, 2, 3])  # shape (3,) -> (2, 3)
a + b
```

---

### ✅ 六、索引和切片

```python
x = torch.arange(12).reshape((3, 4))
x[0, :]      # 第0行
x[:, 1]      # 第1列
x[1:3, :]    # 第1到2行
x[x > 5]     # 条件筛选
```

---

### ✅ 七、赋值与内存共享

* `a = b` 是**引用**
* 使用 `.clone()` 复制新张量
* 使用 in-place 操作节省内存：

```python
a += b  # 等同于 a = a + b
```

---

### ✅ 八、类型转换

```python
x.float()
x.int()
x.type(torch.DoubleTensor)
x.numpy()  # 转为 numpy
```

---

### ⭐ 总结能力目标：

| 学完后你应该能做什么：               |
| ------------------------- |
| ✅ 熟练创建和操作张量               |
| ✅ 能读懂形状变化，避免 shape 报错     |
| ✅ 用广播写简洁代码                |
| ✅ 为神经网络准备输入张量（如reshape图像） |
| ✅ 初步理解“数据”和“计算”的连接        |
